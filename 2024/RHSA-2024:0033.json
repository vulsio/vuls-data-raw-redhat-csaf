{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "Moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "An update for redhat-release-virtualization-host and redhat-virtualization-host is now available for Red Hat Virtualization 4 for Red Hat Enterprise Linux 8.\n\nRed Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.",
				"title": "Topic"
			},
			{
				"category": "general",
				"text": "The redhat-virtualization-host packages provide the Red Hat Virtualization Host. These packages include redhat-release-virtualization-host, ovirt-node, and rhev-hypervisor. Red Hat Virtualization Hosts (RHVH) are installed using a special build of Red Hat Enterprise Linux with only the packages required to host virtual machines. RHVH features a Cockpit user interface for monitoring the host's resources and performing administrative tasks.\n\nSecurity Fix(es):\n\nFor more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.",
				"title": "Details"
			},
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "https://access.redhat.com/errata/RHSA-2024:0033",
				"url": "https://access.redhat.com/errata/RHSA-2024:0033"
			},
			{
				"category": "external",
				"summary": "https://access.redhat.com/security/updates/classification/#moderate",
				"url": "https://access.redhat.com/security/updates/classification/#moderate"
			},
			{
				"category": "external",
				"summary": "2238352",
				"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2238352"
			},
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/advisories/2024/rhsa-2024_0033.json"
			}
		],
		"title": "Red Hat Security Advisory: Red Hat Virtualization Host 4.4.z SP 1 security update",
		"tracking": {
			"current_release_date": "2024-01-03T15:30:46+00:00",
			"generator": {
				"date": "2024-01-03T15:30:46+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.26.0"
				}
			},
			"id": "RHSA-2024:0033",
			"initial_release_date": "2024-01-03T14:10:38+00:00",
			"revision_history": [
				{
					"date": "2024-01-03T14:10:38+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2024-01-03T14:10:38+00:00",
					"number": "2",
					"summary": "Last updated version"
				},
				{
					"date": "2024-01-03T15:30:46+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
								"product": {
									"name": "RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
									"product_id": "8Base-RHV-HypervisorBuild-4",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
									}
								}
							},
							{
								"category": "product_name",
								"name": "Red Hat Virtualization 4 Hypervisor for RHEL 8",
								"product": {
									"name": "Red Hat Virtualization 4 Hypervisor for RHEL 8",
									"product_id": "8Base-RHV-Hypervisor-4",
									"product_identification_helper": {
										"cpe": "cpe:/o:redhat:enterprise_linux:8::hypervisor"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Virtualization"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
								"product": {
									"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
									"product_id": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-release-virtualization-host@4.5.3-10.el8ev?arch=src"
									}
								}
							},
							{
								"category": "product_version",
								"name": "redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
								"product": {
									"name": "redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
									"product_id": "redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-virtualization-host@4.5.3-202312060823_8.6?arch=src"
									}
								}
							}
						],
						"category": "architecture",
						"name": "src"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
								"product": {
									"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
									"product_id": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-release-virtualization-host@4.5.3-10.el8ev?arch=x86_64"
									}
								}
							},
							{
								"category": "product_version",
								"name": "redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
								"product": {
									"name": "redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
									"product_id": "redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-release-virtualization-host-content@4.5.3-10.el8ev?arch=x86_64"
									}
								}
							},
							{
								"category": "product_version",
								"name": "redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
								"product": {
									"name": "redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
									"product_id": "redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-virtualization-host-image-update@4.5.3-202312060823_8.6?arch=x86_64"
									}
								}
							}
						],
						"category": "architecture",
						"name": "x86_64"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch",
								"product": {
									"name": "redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch",
									"product_id": "redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/redhat-virtualization-host-image-update-placeholder@4.5.3-10.el8ev?arch=noarch"
									}
								}
							}
						],
						"category": "architecture",
						"name": "noarch"
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-virtualization-host-0:4.5.3-202312060823_8.6.src as a component of Red Hat Virtualization 4 Hypervisor for RHEL 8",
					"product_id": "8Base-RHV-Hypervisor-4:redhat-virtualization-host-0:4.5.3-202312060823_8.6.src"
				},
				"product_reference": "redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
				"relates_to_product_reference": "8Base-RHV-Hypervisor-4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64 as a component of Red Hat Virtualization 4 Hypervisor for RHEL 8",
					"product_id": "8Base-RHV-Hypervisor-4:redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64"
				},
				"product_reference": "redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
				"relates_to_product_reference": "8Base-RHV-Hypervisor-4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.src as a component of RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
					"product_id": "8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.src"
				},
				"product_reference": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
				"relates_to_product_reference": "8Base-RHV-HypervisorBuild-4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64 as a component of RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
					"product_id": "8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64"
				},
				"product_reference": "redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
				"relates_to_product_reference": "8Base-RHV-HypervisorBuild-4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64 as a component of RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
					"product_id": "8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64"
				},
				"product_reference": "redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
				"relates_to_product_reference": "8Base-RHV-HypervisorBuild-4"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch as a component of RHEL 8-based RHEV-H for RHEV 4 (build requirements)",
					"product_id": "8Base-RHV-HypervisorBuild-4:redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch"
				},
				"product_reference": "redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch",
				"relates_to_product_reference": "8Base-RHV-HypervisorBuild-4"
			}
		]
	},
	"vulnerabilities": [
		{
			"acknowledgments": [
				{
					"names": [
						"Qualys Research Labs"
					]
				}
			],
			"cve": "CVE-2023-4911",
			"cwe": {
				"id": "CWE-122",
				"name": "Heap-based Buffer Overflow"
			},
			"discovery_date": "2023-09-04T00:00:00+00:00",
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2238352"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A buffer overflow was discovered in the GNU C Library's dynamic loader ld.so while processing the GLIBC_TUNABLES environment variable. This issue could allow a local attacker to use maliciously crafted GLIBC_TUNABLES environment variables when launching binaries with SUID permission to execute code with elevated privileges.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "glibc: buffer overflow in ld.so leading to privilege escalation",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "This vulnerability was introduced in glibc version 2.34. RHEL-8 ships glibc 2.28, which is not originally affected by this vulnerability. However, the commit that introduced this vulnerability was backported to RHEL-8.5, making this version and onward vulnerable. RHEL-8.4 and older are not affected by this vulnerability.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"fixed": [
					"8Base-RHV-Hypervisor-4:redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
					"8Base-RHV-Hypervisor-4:redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
					"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
					"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
					"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
					"8Base-RHV-HypervisorBuild-4:redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2023-4911"
				},
				{
					"category": "external",
					"summary": "RHBZ#2238352",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2238352"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2023-4911",
					"url": "https://www.cve.org/CVERecord?id=CVE-2023-4911"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2023-4911",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2023-4911"
				},
				{
					"category": "external",
					"summary": "https://www.qualys.com/2023/10/03/cve-2023-4911/looney-tunables-local-privilege-escalation-glibc-ld-so.txt",
					"url": "https://www.qualys.com/2023/10/03/cve-2023-4911/looney-tunables-local-privilege-escalation-glibc-ld-so.txt"
				},
				{
					"category": "external",
					"summary": "https://www.qualys.com/cve-2023-4911/",
					"url": "https://www.qualys.com/cve-2023-4911/"
				}
			],
			"release_date": "2023-10-03T17:00:00+00:00",
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "For details on how to apply this update, which includes the changes described in this advisory, refer to:\n\nhttps://access.redhat.com/articles/2974891",
					"product_ids": [
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch"
					],
					"restart_required": {
						"category": "none"
					},
					"url": "https://access.redhat.com/errata/RHSA-2024:0033"
				},
				{
					"category": "workaround",
					"details": "For customers who cannot update immediately and do not have Secure Boot feature enabled, the issue can be mitigated using the provided SystemTap script with the following steps.  When enabled, any setuid program invoked with GLIBC_TUNABLES in the environment will be terminated immediately.  To invoke the setuid program, users will then have to unset or clear the GLIBC_TUNABLES envvar, e.g. `GLIBC_TUNABLES= sudo` . \n\nNote that these mitigation steps will need to be repeated if the system is rebooted.\n\n1)    Install required systemtap packages and dependencies as per - https://access.redhat.com/solutions/5441\n\n\n2)    Create the following systemtap script, and name it stap_block_suid_tunables.stp:\n    ~~~\nfunction has_tunable_string:long()\n{\n  name = \"GLIBC_TUNABLES\"\n\n  mm = @task(task_current())->mm;\n  if (mm)\n    {\n      env_start = @mm(mm)->env_start;\n      env_end = @mm(mm)->env_end;\n\n      if (env_start != 0 && env_end != 0)\n        while (env_end > env_start)\n          {\n            cur = user_string(env_start, \"\");\n            env_name = tokenize(cur, \"=\");\n      \n            if (env_name == name && tokenize(\"\", \"\") != \"\")\n              return 1;\n            env_start += strlen (cur) + 1\n          }\n    }\n\n  return 0;\n}\n\nprobe process(\"/lib*/ld*.so*\").function(\"__tunables_init\")\n{\n  atsecure = 0;\n  /* Skip processing if we can't read __libc_enable_secure, e.g. core dump\n     handler (systemd-cgroups-agent and systemd-coredump).  */\n  try { atsecure = @var(\"__libc_enable_secure\"); }\n  catch { printk (4, sprintf (\"CVE-2023-4911: Skipped check: %s (%d)\", execname(), pid())); }\n  if (atsecure && has_tunable_string ())\n    raise (9);\n}\n~~~\n\n3) Load the systemtap module into the running kernel:\n    ~~~\n    stap -g -F -m stap_block_suid_tunables stap_block_suid_tunables.stp\n    ~~~\n\n4) Ensure the module is loaded:\n    ~~~\n     lsmod | grep -i stap_block_suid_tunables\nstap_block_suid_tunables     249856  0\n~~~\n\n5) Once the glibc package is updated to the version containing the fix, the systemtap generated kernel module can be removed by running:\n    ~~~\n    rmmod stap_block_suid_tunables\n    ~~~\n\nIf Secure Boot is enabled on a system, the SystemTap module must be signed. An external compiling server can be used to sign the generated kernel module with a key enrolled into the kernel's keyring or starting with SystemTap 4.7 you can sign a module without a compile server. See further information here - https://www.redhat.com/sysadmin/secure-boot-systemtap",
					"product_ids": [
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "LOCAL",
						"availabilityImpact": "HIGH",
						"baseScore": 7.8,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-0:4.5.3-202312060823_8.6.src",
						"8Base-RHV-Hypervisor-4:redhat-virtualization-host-image-update-0:4.5.3-202312060823_8.6.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.src",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-release-virtualization-host-content-0:4.5.3-10.el8ev.x86_64",
						"8Base-RHV-HypervisorBuild-4:redhat-virtualization-host-image-update-placeholder-0:4.5.3-10.el8ev.noarch"
					]
				}
			],
			"threats": [
				{
					"category": "exploit_status",
					"date": "2023-11-21T00:00:00+00:00",
					"details": "CISA: https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
				},
				{
					"category": "impact",
					"details": "Important"
				}
			],
			"title": "glibc: buffer overflow in ld.so leading to privilege escalation"
		}
	]
}
