{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "Moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "An update for rh-maven36-log4j12 is now available for Red Hat Software Collections.\n\nRed Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.",
				"title": "Topic"
			},
			{
				"category": "general",
				"text": "Log4j is a tool to help the programmer output log statements to a variety of output targets.\n\nSecurity Fix(es):\n\n* log4j: Remote code execution in Log4j 1.x when application is configured to use JMSAppender (CVE-2021-4104)\n\nFor more details about the security issue(s), including the impact, a CVSS score, acknowledgments, and other related information, refer to the CVE page(s) listed in the References section.",
				"title": "Details"
			},
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "https://access.redhat.com/errata/RHSA-2021:5269",
				"url": "https://access.redhat.com/errata/RHSA-2021:5269"
			},
			{
				"category": "external",
				"summary": "https://access.redhat.com/security/updates/classification/#moderate",
				"url": "https://access.redhat.com/security/updates/classification/#moderate"
			},
			{
				"category": "external",
				"summary": "https://access.redhat.com/security/vulnerabilities/RHSB-2021-009",
				"url": "https://access.redhat.com/security/vulnerabilities/RHSB-2021-009"
			},
			{
				"category": "external",
				"summary": "2031667",
				"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2031667"
			},
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://access.redhat.com/security/data/csaf/v2/advisories/2021/rhsa-2021_5269.json"
			}
		],
		"title": "Red Hat Security Advisory: rh-maven36-log4j12 security update",
		"tracking": {
			"current_release_date": "2024-04-21T10:26:59+00:00",
			"generator": {
				"date": "2024-04-21T10:26:59+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "3.29.1"
				}
			},
			"id": "RHSA-2021:5269",
			"initial_release_date": "2021-12-22T21:29:25+00:00",
			"revision_history": [
				{
					"date": "2021-12-22T21:29:25+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2021-12-22T21:29:25+00:00",
					"number": "2",
					"summary": "Last updated version"
				},
				{
					"date": "2024-04-21T10:26:59+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat Software Collections for RHEL Workstation(v. 7)",
								"product": {
									"name": "Red Hat Software Collections for RHEL Workstation(v. 7)",
									"product_id": "7Server-RHSCL-3.8",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
									}
								}
							},
							{
								"category": "product_name",
								"name": "Red Hat Software Collections for RHEL(v. 7)",
								"product": {
									"name": "Red Hat Software Collections for RHEL(v. 7)",
									"product_id": "7Workstation-RHSCL-3.8",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:rhel_software_collections:3::el7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat Software Collections"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
								"product": {
									"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
									"product_id": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/rh-maven36-log4j12@1.2.17-23.3.el7?arch=src"
									}
								}
							}
						],
						"category": "architecture",
						"name": "src"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
								"product": {
									"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
									"product_id": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/rh-maven36-log4j12@1.2.17-23.3.el7?arch=noarch"
									}
								}
							},
							{
								"category": "product_version",
								"name": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
								"product": {
									"name": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
									"product_id": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
									"product_identification_helper": {
										"purl": "pkg:rpm/redhat/rh-maven36-log4j12-javadoc@1.2.17-23.3.el7?arch=noarch"
									}
								}
							}
						],
						"category": "architecture",
						"name": "noarch"
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch as a component of Red Hat Software Collections for RHEL Workstation(v. 7)",
					"product_id": "7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch"
				},
				"product_reference": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
				"relates_to_product_reference": "7Server-RHSCL-3.8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src as a component of Red Hat Software Collections for RHEL Workstation(v. 7)",
					"product_id": "7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src"
				},
				"product_reference": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
				"relates_to_product_reference": "7Server-RHSCL-3.8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch as a component of Red Hat Software Collections for RHEL Workstation(v. 7)",
					"product_id": "7Server-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
				},
				"product_reference": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
				"relates_to_product_reference": "7Server-RHSCL-3.8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch as a component of Red Hat Software Collections for RHEL(v. 7)",
					"product_id": "7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch"
				},
				"product_reference": "rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
				"relates_to_product_reference": "7Workstation-RHSCL-3.8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src as a component of Red Hat Software Collections for RHEL(v. 7)",
					"product_id": "7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src"
				},
				"product_reference": "rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
				"relates_to_product_reference": "7Workstation-RHSCL-3.8"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch as a component of Red Hat Software Collections for RHEL(v. 7)",
					"product_id": "7Workstation-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
				},
				"product_reference": "rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
				"relates_to_product_reference": "7Workstation-RHSCL-3.8"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2021-4104",
			"cwe": {
				"id": "CWE-20",
				"name": "Improper Input Validation"
			},
			"discovery_date": "2021-12-13T00:00:00+00:00",
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2031667"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A flaw was found in the Java logging library Apache Log4j in version 1.x. JMSAppender in Log4j 1.x is vulnerable to deserialization of untrusted data. This allows a remote attacker to execute code on the server if the deployed application is configured to use JMSAppender and to the attacker's JNDI LDAP endpoint.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "log4j: Remote code execution in Log4j 1.x when application is configured to use JMSAppender",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "Based on the conditions to be exploitable (see details below), the risk is much lower than Log4j 2.x and Red Hat has assessed this to be Moderate severity. This flaw has been filed for Log4j 1.x, and the corresponding flaw information for Log4j 2.x is available at: https://access.redhat.com/security/cve/CVE-2021-44228\n\nNote this flaw ONLY affects applications which are specifically configured to use JMSAppender, which is not the default, or when the attacker has write access to the Log4j configuration for adding JMSAppender to the attacker's JNDI LDAP endpoint. \n\nIf the Log4j configuration is set TopicBindingName or TopicConnectionFactoryBindingName configurations allowing JMSAppender to perform JNDI requests that result in remote code execution in a similar fashion to CVE-2021-44228 Log4j 2.x, Log4j 1.x is vulnerable. However, the attack vector is reduced as it depends on having write access, which is not a standard configuration rather than untrusted user input. These are sufficient factors beyond the attacker's control.\n\nThe tomcat package shipped with Red Hat Enterprise Linux does not include log4j but it does include a default configuration for log4j, log4j.properties, which could be used with tomcat if users choose to install and configure the library. The JMSAppender is not enabled by default, and the permissions of the file can only be modified as root.\n\nRed Hat Virtualization ships log4j12-1.2.17, but it is used and configured in a way which makes this flaw not possible to exploit. Therefore impact is rated Low.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"fixed": [
					"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
					"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
					"7Server-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
					"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
					"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
					"7Workstation-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2021-4104"
				},
				{
					"category": "external",
					"summary": "RHBZ#2031667",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2031667"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2021-4104",
					"url": "https://www.cve.org/CVERecord?id=CVE-2021-4104"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-4104",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2021-4104"
				},
				{
					"category": "external",
					"summary": "https://github.com/apache/logging-log4j2/pull/608#issuecomment-990494126",
					"url": "https://github.com/apache/logging-log4j2/pull/608#issuecomment-990494126"
				},
				{
					"category": "external",
					"summary": "https://github.com/apache/logging-log4j2/pull/608#issuecomment-991723301",
					"url": "https://github.com/apache/logging-log4j2/pull/608#issuecomment-991723301"
				},
				{
					"category": "external",
					"summary": "https://lists.apache.org/thread/0x4zvtq92yggdgvwfgsftqrj4xx5w0nx",
					"url": "https://lists.apache.org/thread/0x4zvtq92yggdgvwfgsftqrj4xx5w0nx"
				},
				{
					"category": "external",
					"summary": "https://www.openwall.com/lists/oss-security/2021/12/13/1",
					"url": "https://www.openwall.com/lists/oss-security/2021/12/13/1"
				}
			],
			"release_date": "2021-12-10T00:00:00+00:00",
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "For details on how to apply this update, which includes the changes described in this advisory, refer to:\n\nhttps://access.redhat.com/articles/11258",
					"product_ids": [
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
					],
					"restart_required": {
						"category": "none"
					},
					"url": "https://access.redhat.com/errata/RHSA-2021:5269"
				},
				{
					"category": "workaround",
					"details": "These are the possible mitigations for this flaw for releases version 1.x:\n\n- Comment out or remove JMSAppender in the Log4j configuration if it is used\n- Remove the JMSAppender class from the classpath. For example:\n```\nzip -q -d log4j-*.jar org/apache/log4j/net/JMSAppender.class\n```\n- Restrict access for the OS user on the platform running the application to prevent modifying the Log4j configuration by the attacker.",
					"product_ids": [
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "HIGH",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 7.5,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "LOW",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Server-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.noarch",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-0:1.2.17-23.3.el7.src",
						"7Workstation-RHSCL-3.8:rh-maven36-log4j12-javadoc-0:1.2.17-23.3.el7.noarch"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"details": "Moderate"
				}
			],
			"title": "log4j: Remote code execution in Log4j 1.x when application is configured to use JMSAppender"
		}
	]
}
