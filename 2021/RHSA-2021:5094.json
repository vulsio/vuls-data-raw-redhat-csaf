{
	"document": {
		"aggregate_severity": {
			"namespace": "https://access.redhat.com/security/updates/classification/",
			"text": "Moderate"
		},
		"category": "csaf_security_advisory",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright Â© Red Hat, Inc. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "Red Hat OpenShift Container Platform release 3.11.z is now available with\nupdates to packages and images that fix several bugs and add enhancements.\n\nRed Hat Product Security has rated this update as having a security impact\nof Moderate. A Common Vulnerability Scoring System (CVSS) base score, which\ngives a detailed severity rating, is available for each vulnerability from\nthe CVE link(s) in the References section.",
				"title": "Topic"
			},
			{
				"category": "general",
				"text": "Red Hat OpenShift Container Platform is Red Hat's cloud computing\nKubernetes application platform solution designed for on-premise or private\ncloud deployments.\n\nSecurity Fix(es):\n\n* log4j-core: Remote code execution in Log4j 2.x when logs contain an\nattacker-controlled string value (CVE-2021-44228)\n\nFor more details about the security issue(s), including the impact, a CVSS\nscore, acknowledgments, and other related information, refer to the CVE\npage(s)\nlisted in the References section.",
				"title": "Details"
			},
			{
				"category": "legal_disclaimer",
				"text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
				"title": "Terms of Use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://access.redhat.com/security/team/contact/",
			"issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
			"name": "Red Hat Product Security",
			"namespace": "https://www.redhat.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "https://access.redhat.com/errata/RHSA-2021:5094",
				"url": "https://access.redhat.com/errata/RHSA-2021:5094"
			},
			{
				"category": "external",
				"summary": "https://access.redhat.com/security/updates/classification/#moderate",
				"url": "https://access.redhat.com/security/updates/classification/#moderate"
			},
			{
				"category": "external",
				"summary": "https://access.redhat.com/security/vulnerabilities/RHSB-2021-009",
				"url": "https://access.redhat.com/security/vulnerabilities/RHSB-2021-009"
			},
			{
				"category": "external",
				"summary": "2030932",
				"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2030932"
			},
			{
				"category": "self",
				"summary": "Canonical URL",
				"url": "https://security.access.redhat.com/data/csaf/v2/advisories/2021/rhsa-2021_5094.json"
			}
		],
		"title": "Red Hat Security Advisory: OpenShift Container Platform 3.11.z security update",
		"tracking": {
			"current_release_date": "2024-11-21T21:14:22+00:00",
			"generator": {
				"date": "2024-11-21T21:14:22+00:00",
				"engine": {
					"name": "Red Hat SDEngine",
					"version": "4.2.1"
				}
			},
			"id": "RHSA-2021:5094",
			"initial_release_date": "2021-12-14T05:50:14+00:00",
			"revision_history": [
				{
					"date": "2021-12-14T05:50:14+00:00",
					"number": "1",
					"summary": "Initial version"
				},
				{
					"date": "2021-12-14T05:50:14+00:00",
					"number": "2",
					"summary": "Last updated version"
				},
				{
					"date": "2024-11-21T21:14:22+00:00",
					"number": "3",
					"summary": "Last generated version"
				}
			],
			"status": "final",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "Red Hat OpenShift Container Platform 3.11",
								"product": {
									"name": "Red Hat OpenShift Container Platform 3.11",
									"product_id": "7Server-RH7-RHOSE-3.11",
									"product_identification_helper": {
										"cpe": "cpe:/a:redhat:openshift:3.11::el7"
									}
								}
							}
						],
						"category": "product_family",
						"name": "Red Hat OpenShift Enterprise"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64",
								"product": {
									"name": "openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64",
									"product_id": "openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64",
									"product_identification_helper": {
										"purl": "pkg:oci/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2?arch=amd64&repository_url=registry.redhat.io/openshift3/ose-logging-elasticsearch5&tag=v3.11.570-2.gd119820"
									}
								}
							}
						],
						"category": "architecture",
						"name": "amd64"
					}
				],
				"category": "vendor",
				"name": "Red Hat"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64 as a component of Red Hat OpenShift Container Platform 3.11",
					"product_id": "7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
				},
				"product_reference": "openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64",
				"relates_to_product_reference": "7Server-RH7-RHOSE-3.11"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2021-44228",
			"cwe": {
				"id": "CWE-20",
				"name": "Improper Input Validation"
			},
			"discovery_date": "2021-12-10T00:00:00+00:00",
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2030932"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A flaw was found in the Apache Log4j logging library in versions from 2.0.0 and before 2.15.0. A remote attacker who can control log messages or log message parameters, can execute arbitrary code on the server via JNDI LDAP endpoint.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "log4j-core: Remote code execution in Log4j 2.x when logs contain an attacker-controlled string value",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "This issue only affects log4j versions between 2.0  and 2.14.1. In order to exploit this flaw you need:\n- A remotely accessible endpoint with any protocol (HTTP, TCP, etc) that allows an attacker to send arbitrary data,\n- A log statement in the endpoint that logs the attacker controlled data.\n\nIn Red Hat OpenShift Logging the vulnerable log4j library is shipped in the Elasticsearch components. Because Elasticsearch is not susceptible to remote code execution with this vulnerability due to use of the Java Security Manager and because access to these components is limited, the impact by this vulnerability is reduced to Moderate.\n\nAs per upstream applications using Log4j 1.x may be impacted by this flaw if their configuration uses JNDI. However, the risk is much lower. This flaw in Log4j 1.x is tracked via https://access.redhat.com/security/cve/CVE-2021-4104 and has been rated as having Moderate security impact.\n\nCodeReady Studio version 12.21.1 was released containing a fix for this vulnerability.\n\nThe following products are NOT affected by this flaw and have been explicitly listed here for the benefit of our customers.\n- Red Hat Enterprise Linux\n- Red Hat Advanced Cluster Management for Kubernetes \n- Red Hat Advanced Cluster Security for Kubernetes\n- Red Hat Ansible Automation Platform (Engine and Tower)\n- Red Hat Certificate System\n- Red Hat Directory Server\n- Red Hat Identity Management\n- Red Hat CloudForms \n- Red Hat Update Infrastructure\n- Red Hat Satellite\n- Red Hat Ceph Storage\n- Red Hat Gluster Storage\n- Red Hat OpenShift Data Foundation\n- Red Hat OpenStack Platform\n- Red Hat Virtualization\n- Red Hat Single Sign-On\n- Red Hat 3scale API Management",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"fixed": [
					"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2021-44228"
				},
				{
					"category": "external",
					"summary": "RHBZ#2030932",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2030932"
				},
				{
					"category": "external",
					"summary": "RHSB-2021-009",
					"url": "https://access.redhat.com/security/vulnerabilities/RHSB-2021-009"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2021-44228",
					"url": "https://www.cve.org/CVERecord?id=CVE-2021-44228"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-44228",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2021-44228"
				},
				{
					"category": "external",
					"summary": "https://github.com/advisories/GHSA-jfh8-c2jp-5v3q",
					"url": "https://github.com/advisories/GHSA-jfh8-c2jp-5v3q"
				},
				{
					"category": "external",
					"summary": "https://logging.apache.org/log4j/2.x/security.html",
					"url": "https://logging.apache.org/log4j/2.x/security.html"
				},
				{
					"category": "external",
					"summary": "https://www.lunasec.io/docs/blog/log4j-zero-day/",
					"url": "https://www.lunasec.io/docs/blog/log4j-zero-day/"
				},
				{
					"category": "external",
					"summary": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
					"url": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
				}
			],
			"release_date": "2021-12-10T02:01:00+00:00",
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "See the following documentation, which will be updated shortly for release\n3.11.z, for important instructions on how to upgrade your cluster and fully\napply this asynchronous errata update:\n\nhttps://docs.openshift.com/container-platform/3.11/release_notes/ocp_3_11_release_notes.html\n\nThis update is available via the Red Hat Network. Details on how to use the\nRed Hat Network to apply this update are available at\nhttps://access.redhat.com/articles/11258 .",
					"product_ids": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					],
					"restart_required": {
						"category": "none"
					},
					"url": "https://access.redhat.com/errata/RHSA-2021:5094"
				},
				{
					"category": "workaround",
					"details": "For Log4j versions >=2.10\nset the system property log4j2.formatMsgNoLookups or the environment variable LOG4J_FORMAT_MSG_NO_LOOKUPS to true\n\nFor Log4j versions >=2.7 and <=2.14.1\nall PatternLayout patterns can be modified to specify the message converter as %m{nolookups} instead of just %m\n\nFor Log4j versions >=2.0-beta9 and <=2.10.0\nremove the JndiLookup class from the classpath. For example: \n```\nzip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class\n```\n\nOn OpenShift 4 and in OpenShift Logging, the above mitigation can be applied by following the steps in this article: https://access.redhat.com/solutions/6578421\n\nOn OpenShift 3.11, mitigation to the affected Elasticsearch component can be applied by following the steps in this article: https://access.redhat.com/solutions/6578441",
					"product_ids": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "LOW",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 9.8,
						"baseSeverity": "CRITICAL",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "NONE",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					]
				}
			],
			"threats": [
				{
					"category": "exploit_status",
					"date": "2021-12-10T00:00:00+00:00",
					"details": "CISA: https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
				},
				{
					"category": "impact",
					"details": "Moderate"
				}
			],
			"title": "log4j-core: Remote code execution in Log4j 2.x when logs contain an attacker-controlled string value"
		},
		{
			"cve": "CVE-2021-45046",
			"cwe": {
				"id": "CWE-400",
				"name": "Uncontrolled Resource Consumption"
			},
			"discovery_date": "2021-12-14T00:00:00+00:00",
			"ids": [
				{
					"system_name": "Red Hat Bugzilla ID",
					"text": "2032580"
				}
			],
			"notes": [
				{
					"category": "description",
					"text": "A flaw was found in the Apache Log4j logging library in versions from 2.0.0 and before 2.16.0. A remote attacker with control over Thread Context Map (MDC) input data could craft malicious input using a JNDI Lookup pattern resulting in remote code execution (RCE) in a limited number of environments.",
					"title": "Vulnerability description"
				},
				{
					"category": "summary",
					"text": "log4j-core: DoS in log4j 2.x with thread context message pattern and context lookup pattern (incomplete fix for CVE-2021-44228)",
					"title": "Vulnerability summary"
				},
				{
					"category": "other",
					"text": "Although we have matched Apache's CVSS score, with the exception of the scope metric which will remain unaltered at \"unchanged\"; as we believe code execution would be at the permission levels of the running JVM and not exceeding that of the original CVE-2021-44228 flaw.\n \nWe have given this vulnerability an impact rating of Moderate, this is because of the unlikely nature of log4j lookup mapping values being derived from attacker controlled values. This is not the default configuration for end-applications using log4j 2.x and would require explicit action from a privileged user (a developer or administrator) to access the vulnerability. \nIn certain non-default configurations, it was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was insufficient.\n\nThis issue affects the log4j version between 2.0 and 2.15. Log4j 1.x is NOT impacted by this vulnerability. \n\nPrerequisites to exploit this flaw are :\n\n- A remotely accessible endpoint with any protocol (HTTP, TCP, etc) that allows an attacker to send arbitrary data,\n- A log statement in the endpoint that logs the attacker controlled data.\n- Log4j configuration file should be explicitly configured to use a non-default Pattern Layout with a Context Lookup eg. ($${ctx:loginId}) \n\nIn most cases, the mitigation suggested for CVE-2021-44228 (i.e. to set the system property `log4j2.noFormatMsgLookup` to `true) does NOT mitigate this specific vulnerability. \nLog4j 2.16.0 fixes this issue by removing support for message lookup patterns and disabling JNDI functionality by default.\n\nFor Elasticsearch, as shipped in OpenShift 3.11, the \"log4j2.formatMsgNoLookups=true\" system property mitigation is sufficient as there are no included non-standard configurations that allow for exploitation:\n\nhttps://github.com/openshift/openshift-ansible/blob/release-3.11/roles/openshift_logging_elasticsearch/templates/log4j2.properties.j2\n\nhttps://discuss.elastic.co/t/apache-log4j2-remote-code-execution-rce-vulnerability-cve-2021-44228-esa-2021-31/291476\n\nFor CodeReady Studio the fix for this flaw is available on CodeReady Studio 12.21.3 and above versions.",
					"title": "Statement"
				},
				{
					"category": "general",
					"text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
					"title": "CVSS score applicability"
				}
			],
			"product_status": {
				"fixed": [
					"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
				]
			},
			"references": [
				{
					"category": "self",
					"summary": "Canonical URL",
					"url": "https://access.redhat.com/security/cve/CVE-2021-45046"
				},
				{
					"category": "external",
					"summary": "RHBZ#2032580",
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2032580"
				},
				{
					"category": "external",
					"summary": "https://www.cve.org/CVERecord?id=CVE-2021-45046",
					"url": "https://www.cve.org/CVERecord?id=CVE-2021-45046"
				},
				{
					"category": "external",
					"summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-45046",
					"url": "https://nvd.nist.gov/vuln/detail/CVE-2021-45046"
				},
				{
					"category": "external",
					"summary": "https://access.redhat.com/security/cve/CVE-2021-44228",
					"url": "https://access.redhat.com/security/cve/CVE-2021-44228"
				},
				{
					"category": "external",
					"summary": "https://logging.apache.org/log4j/2.x/security.html",
					"url": "https://logging.apache.org/log4j/2.x/security.html"
				},
				{
					"category": "external",
					"summary": "https://www.openwall.com/lists/oss-security/2021/12/14/4",
					"url": "https://www.openwall.com/lists/oss-security/2021/12/14/4"
				},
				{
					"category": "external",
					"summary": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
					"url": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
				}
			],
			"release_date": "2021-12-14T00:00:00+00:00",
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "See the following documentation, which will be updated shortly for release\n3.11.z, for important instructions on how to upgrade your cluster and fully\napply this asynchronous errata update:\n\nhttps://docs.openshift.com/container-platform/3.11/release_notes/ocp_3_11_release_notes.html\n\nThis update is available via the Red Hat Network. Details on how to use the\nRed Hat Network to apply this update are available at\nhttps://access.redhat.com/articles/11258 .",
					"product_ids": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					],
					"restart_required": {
						"category": "none"
					},
					"url": "https://access.redhat.com/errata/RHSA-2021:5094"
				},
				{
					"category": "workaround",
					"details": "For Log4j versions up to and including 2.15.0, this issue can be mitigated by removing the JndiLookup class from the classpath (example: zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class).",
					"product_ids": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"attackComplexity": "HIGH",
						"attackVector": "NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 8.1,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"privilegesRequired": "NONE",
						"scope": "UNCHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"7Server-RH7-RHOSE-3.11:openshift3/ose-logging-elasticsearch5@sha256:88379eab3d1e07f120b5dc6fa6ba4ebf96d3afb6aaf388d279084d675b23b5c2_amd64"
					]
				}
			],
			"threats": [
				{
					"category": "exploit_status",
					"date": "2023-05-01T00:00:00+00:00",
					"details": "CISA: https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
				},
				{
					"category": "impact",
					"details": "Moderate"
				}
			],
			"title": "log4j-core: DoS in log4j 2.x with thread context message pattern and context lookup pattern (incomplete fix for CVE-2021-44228)"
		}
	]
}
